<HTML>
<CENTER><A HREF = "http://phish.sandia.gov">PHISH WWW Site</A> - <A HREF = "Manual.html">PHISH Documentation</A> - <A HREF = "Bait.html">Bait.py Commands</A> 
</CENTER>






<HR>

<H3>phish_init() function 
</H3>
<H3>phish_school() function 
</H3>
<P><B>C syntax:</B>
</P>
<PRE>void phish_init(int *narg, char ***args) 
</PRE>
<PRE>void phish_school(int *idlocal, int *nlocal, int *idglobal, int *nglobal) 
</PRE>
<P><B>C examples:</B>
</P>
<PRE>phish_init(&argc,&argv);
int idlocal,nlocal,idglobal,nglobal;
MPI_Comm comm = phish_school(&idlocal,&nlocal,&idglobal,&nglobal);
printf("Local minnow info: %d %d\n",idlocal,nlocal);
printf("Global minnow info: %d %d\n",idglobal,nglobal); 
</PRE>
<P><B>Python syntax:</B>
</P>
<PRE>def init(args) 
</PRE>
<PRE>def school() 
</PRE>
<P><B>Python examples:</B>
</P>
<PRE>import phish
args = phish.init(sys.argv)
first_minnow_arg = args<B>0</B>
idlocal,nlocal,idglobal,nglobal = phish.school() 
</PRE>
<P><B>Description:</B>
</P>
<P>These are PHISH library functions which can be called from a minnow
application.  In PHISH lingo, a "minnow" is a stand-alone application
which makes calls to the <A HREF = "Library.html">PHISH library</A>.
</P>
<P>A PHISH program typically includes one or more sets of minnows, as
specified in a PHISH input script.  Each minnow in each set is an
individual process.  In a local sense, each minnow has a local-ID from
0 to Nlocal-1 within its set, where <I>Nlocal</I> is the number of minnows
in the set.  Globally, each minnow has a global-ID from 0 to
Nglobal-1, where <I>Nglobal</I> is the total number of minnows.  The
global-IDs are ordered by set, so that minnows within each set have
consecutive IDs.  These IDs enable the PHISH library to orchestrate
communication of datums between minnows in different sets.  E.g. when
running the MPI version of the PHISH library, the global-ID
corresponsds to the rank ID of an MPI process, used in MPI_Send() and
MPI_Recv() function calls.
</P>
<HR>

<P>The phish_init() function must be the first call to the PHISH library
made by a minnow.  Since it alters the command-line arguments passed
to the minnow, it is typically the first executable line of a minnow
program.
</P>
<P>It's purpose is to initialize the library using special command-line
arguments passed to the minnow when it was launched, typically by the
MPI or socket launch script that the <A HREF = "Bait.html">bait.py</A> tool creates
from a PHISH input script.
</P>
<P>The two arguments to phish_init() are pointers to the number of
command-line arguments, and a pointer to the arguments themselves as
an array of strings.  These are passed as pointers, because the PHISH
library reads and removes the PHISH-specific arguments.  It then
returns the reamining minnow-specific arguments, which the minnow can
read and process.
</P>
<P>Note that in the Python version of phish.init(), the full argument
list is passed as an argument, and the truncated argument list is
returned.
</P>
<P>There are the switches and arguments the PHISH library looks for and
processes:
</P>
<UL><LI>-minnow exefile ID Nlocal Nprev
<LI>-in sprocs sfirst sport style rprocs rfirst rport
<LI>-out sprocs sfirst sport style rprocs rfirst rport
<LI>-args arg1 arg2 ... = args for the minnoq itself 
</UL>
<P>The <I>-minnow</I> switch appears once, as the first argument.  <I>Exefile</I>
is the name of executable file for this minnow, e.g. count or
count.py.  The ID is the minnow ID in the PHISH input script.  The
<I>Nlocal</I> argument was explained above.  <I>Nprev</I> is the total number of
minnows in sets of minnows previous to this one.  It is used to infer
the <I>local-ID</I> value discussed above.
</P>
<P>The <I>-in</I> switch appears once for every connection the minnow has with
other minnows, where it is a receiver of datums.  See the
<A HREF = "bait_connect.html">connect</A> command in PHISH input scripts processed
by the <A HREF = "Bait.html">bait.py</A> tool, for more information.
</P>
<P><I>Sprocs</I>, <I>sfirst</I>, and <I>sport</I> refer to the set of minnows sending to
this minnow.  They are respectively, the number of minnows in the set,
the global ID of the first minnow in the set, and the output port used
by those minnows.  <I>Rprocs</I>, <I>rfirst</I>, and <I>rport</I> refer to the set of
minnows receivng the datums, i.e. the set of minnows this minnow
belongs to.  They are respectively, the number of minnows in the set,
the global ID of the first minnow in the set, and the input port used
by those minnows.  <I>Style</I> is the connection style, as specified by
the <A HREF = "bait_connect.html">connect</A> command in the PHISH input script
processed by the <A HREF = "Bait.html">bait.py</A> tool.  E.g. <I>style</I> is a word
like "single" or "hashed".  If it is "subscribe", then extra info
about the external host and its TCP port is appended to the <I>style</I>,
e.g. "subscribe/www.foo.com:25".
</P>
<P>The <I>-out</I> switch appears once for every connection the minnow has
with other minnows, where it is a sender of datums.  See the
<A HREF = "bait_connect.html">connect</A> command in PHISH input scripts processed
by the <A HREF = "Bait.html">bait.py</A> tool, for more information.
</P>
<P><I>Sprocs</I>, <I>sfirst</I>, and <I>sport</I> refer to the set of minnows sending
datums, i.e. the set of minnows this minnow belongs to.  They are
respectively, the number of minnows in the set, the global ID of the
first minnow in the set, and the output port used by those minnows.
<I>Rprocs</I>, <I>rfirst</I>, and <I>rport</I> refer to the set of minnows receivng
the datums.  They are respectively, the number of minnows in the set,
the global ID of the first minnow in the set, and the input port used
by those minnows.  <I>Style</I> is the connection style, as specified by
the <A HREF = "bait_connect.html">connect</A> command in the PHISH input script
processed by the <A HREF = "Bait.html">bait.py</A> tool.  E.g. <I>style</I> is a word
like "single" or "hashed".  If it is "publish", then extra info about
the TCP port is appended to the <I>style</I>, e.g. "publish/25".
</P>
<P>The <I>-args</I> switch appears last and lists all the remaining
minnow-specific arguments.  The PHISH library ignores these, but
strips of all command-line arguments up to and including the <I>-args</I>
switch before returning the args to the minnow caller.
</P>
<P>The phish_init() function also flags each specified input port and
output port with a CLOSED status, instead of UNUSED.  See the
<A HREF = "bait_connect.html">connect</A> command for the <A HREF = "Bait.html">bait.py</A> tool
for more info about communication ports.  See the
<A HREF = "phish_input.html">phish_input</A> and <A HREF = "phish_output.html">phish_output</A>
functions for more info about port status.
</P>
<HR>

<P>The phish_school() function can be used to query the local and global
information about the minnow, both within its local set of duplicate
minnows, and within the global school of minnows.
</P>
<P>The meaning of the 4 returned values <I>idlocal</I>, <I>nlocal</I>, <I>idglobal</I>,
and <I>nglobal</I> are as described above for the <I>-minnow</I> command-line
switch.
</P>
<P>NOTE: also need phish_school or a variatnt to tell something
      about other sets connected to?
      for phish_send_direct() function
</P>
<P><B>Restrictions:</B> none
</P>
<P><B>Related commands:</B> none
</P>
</HTML>
