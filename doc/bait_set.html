<HTML>
<CENTER><A HREF = "http://www.sandia.gov/~sjplimp/phish.html">PHISH WWW Site</A> - <A HREF = "Manual.html">PHISH Documentation</A> - <A HREF = "Bait.html">Bait.py Commands</A> 
</CENTER>






<HR>

<H3>set command 
</H3>
<P><B>Syntax:</B>
</P>
<P>set keyword value
</P>
<UL><LI>keyword = <I>memory</I> or <I>safe</I> or <I>port</I> or <I>pernode</I> 

<PRE>  <I>memory</I> value = N
    N = max size of datum in Kbytes
  <I>safe</I> value = M
    M = send a datum "safely" every this many sends
  <I>self</I> value = S
    S = allow queueing of this many messages to self
  <I>pernode</I> value = Nc
    Nc = # of cores per node 
</PRE>

</UL>
<P><B>Examples:</B>
</P>
<PRE>set memory 1024
set safe 10
set self 20 
</PRE>
<P><B>Description:</B>
</P>
<P>Set is a command that can be used in a PHISH input script which is
recognized by the <A HREF = "Bait.html">bait.py</A> setup program.  It resets
default values that are used by the bait.py program as it reads and
processes commands from the PHISH input script.
</P>
<P>The <I>memory</I> keyword sets the maximum length of datums that are
exchanged by minnows when a PHISH program runs.  Send and receive
buffers for datums are allocated by the <A HREF = "Section_library.html">PHISH
library</A>.  Only 2 such buffers are allocated, so
this setting essentially determines the memory footprint of the PHISH
library.
</P>
<P>The <I>N</I> setting is in Kbytes, so that <I>N</I> = 1024 is 1 Mbyte, and <I>N</I> =
1048576 is 1 Gbyte.  The default is <I>N</I> = 1, since typical PHISH
minnows send and receive small datums.
</P>
<P>The <I>safe</I> keyword is only relevant for the MPI version of the PHISH
library.  It causes the library to use a "safe" MPI_Ssend() call every
Mth time it sends a datum, rather than the normal MPI_Send() function.
If M = 0, "safe" sends are never performed.
</P>
<P>Safe in this context refers to messages being dropped if the receiving
process is backed up.  This can happen if a minnow in a PHISH school
of minnows is significantly slower to process datums than all the
others, and a large number of datums are being continually sent to it.
When a safe send is done, an extra handshake is performed between the
sender and receiver to insure the receiver is ready for the datum.
Doing this often enough should effectively throttle the incoming
messages to a slow minnow, so an overflow does not occur.  Note that
the extra handshaking between the MPI processes slows down the rate at
which small messages are exchanged, so you should not normally use
this setting unless MPI errors arise, e.g. due to "too many unexpected
messages".  A good setting for M depends on how many minnows are
sending to the overflowing minnow.  Typical MPI implementations allow
tens of thousands of small incoming messages to be queued, so M = 1000
or 10000 is fine if a single minnow is sending to the minnow.  If 10
minnows are sending to the overflowing minnow, then M should be
reduced by a factor of 10.
</P>
<P>The <I>self</I> keyword is only relevant for the MPI version of the PHISH.
A PHISH net described by an input script can include
<A HREF = "bait_hook.html">hook</A> commands that route datums from a school back to
itself, e.g. in some kind of looping fashion.  This means that a
procesor can send messages to itself.  When this occurs the PHISH
library uses a buffered MPI_Bsend() call.  This avoids a possible hang
due to a blocking send, which can happen in some MPI implementations.
The value of <I>S</I> determines how big a buffer is reserved for the
buffered send operations.  It effectively means how many messsages (of
maximum size, as determined by the memory keyword above), can be sent
to self and buffered before they are received.  In most cases the
small default setting is sufficient, but if a minnow can send many
messages to itself before reading and processing them, you may need to
boost this setting.
</P>
<P>The <I>pernode</I> keyword is only relevant when running a PHISH script
with MPI and when using the <I>bind</I> option for the bait.py
<A HREF = "bait_school.html">school</A> command.  It tells bait.py how many cores
per node (Nc) there are on the system the PHISH script will be run on.
This enables the <I>bind</I> parameters of the <A HREF = "bait_school.html">school</A>
command to be converted into specific node and core assignments for
each instance of each minnow.  See the <A HREF = "bait_school.html">school</A>
command for more details.
</P>
<P><B>Restrictions:</B> none
</P>
<P><B>Related commands:</B>
</P>
<P>See the discussion of command-line arguments for the
<A HREF = "Secttion_bait.html">bait.py</A> tool.
</P>
<P><B>Default:</B>
</P>
<P>The default settings are memory = 1 (1 Kbyte), safe = 0, self = 10,
and pernode = 1.
</P>
</HTML>
